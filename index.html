<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>MySQL Slow Query Log Visualizer</title>

        <link rel="stylesheet" href="css/visualize.css">
        <link rel="stylesheet" href="css/visualize-dark.css">
        <link rel="stylesheet" href="css/style.css">

        <!-- visualizer -->
        <!--<script type="text/javascript" src="js/enhance.js"></script>-->
        <script src="js/script.js"></script>
        <script src="js/excanvas.js"></script>
        <script src="bower_components/jquery-3.7.1.min.js"></script>
        <script src="bower_components/chartjs/chart.umd.js"></script>
        <script src="bower_components/lodash.js"></script>
        <script src="bower_components/clipboard/clipboard.min.js"></script>
        <script src="js/list.js"></script>
    </head>
    <body onload="start();">

        <h1>MySQL Slow Query Log Visualizer</h1>
        <em>If you need to process very large files (&gt;500MB), you will have to call Chrome with <strong>--js-flags="--max-old-space-size=5000"</strong> parameter to increase memory allocatable by Chrome to 5GB</em>
        <div id="drop_zone">Drop log file here</div>

        <output id="drop_result"></output>
        <output id="load_progress"></output>
        <output id="load_result"></output>

        <!-- Global Chart -->
        <div id="global_chart_container" class="chart_container" width="100%" style="display: none">
            <h2>GLOBAL CHART (click twice on graph to define working data)</h2>
            <span id="global_chart_queries_count"></span><br/>
            Time scale : <select id="global_time_scale">
                <option value="minutely">Minutely</option>
                <option value="hourly" selected>Hourly</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
            </select><br/>
            <canvas id="globalChart" class="chart" width="1280px" height="600"></canvas>
        </div>

        <br /><br />

        <!-- Working Chart -->
        <div id="working_chart_container" class="chart_container" width="100%" style="display: none">
            <h2>WORKING CHART (click twice on graph to define new working data)</h2>
            <span id="working_chart_queries_count"></span><br/>
            Time scale : <select id="working_time_scale">
                <option value="minutely">Minutely</option>
                <option value="hourly" selected>Hourly</option>
                <option value="daily">Daily</option>
                <option value="weekly">Weekly</option>
            </select><br/>
            <canvas id="workingChart" class="chart" width="1280px" height="600"></canvas>
        </div>

        <br /><br />

        <!-- Table -->
        <div id="query_results" style="display:none">
            Chart filtering : start=<span id="filterStart"></span>, end=<span id="filterEnd"></span>
            <table id="log_list">
                <thead class="header">
                    <tr id="search">
                        <th colspan="10">
                            <span class="list_search">
                                <span id="search_count"></span>
                                <label for="log_list_search">Filter:</label>
                                <input id="log_list_search" class="search" />
                                <input type="checkbox" class="reverseSearch" />Invert
                            </span>
                        </th>
                    </tr>
                    <tr>
                        <th scope="col" class="sort" data-sort="date">date</th>
                        <th scope="col" class="sort" data-sort="query_time">query time</th>
                        <th scope="col" class="sort" data-sort="lock_time">lock time</th>
                        <th scope="col" class="sort" data-sort="rows_sent">rows sent</th>
                        <th scope="col" class="sort" data-sort="rows_examined">rows examined</th>
                        <th scope="col" class="sort" data-sort="db_name">db name</th>
                        <th scope="col" class="sort" data-sort="query_pattern_filtered_occurences">query pattern on working data</th>
                        <th scope="col" class="sort" data-sort="query_pattern_global_occurences">query pattern on global data</th>
                        <th scope="col" class="sort" data-sort="query_string">query string</th>
                        <th scope="col" class="sort" data-sort="displayed_query_with_stripped_where_clauses">query with stripped where clauses</th>
                    </tr>
                </thead>

                <tbody class="list"></tbody>

                <tfoot>
                    <tr id="log_list_item">
                        <th scope="row" class="date"></th>
                        <td class="query_time"></td>
                        <td class="lock_time"></td>
                        <td class="rows_sent"></td>
                        <td class="rows_examined"></td>
                        <td class="db_name"></td>
                        <td class="query_pattern_filtered_occurences"></td>
                        <td class="query_pattern_global_occurences"></td>
                        <td class="qs"><pre class="query_string"></pre></td>
                        <td class="qs"><pre class="displayed_query_with_stripped_where_clauses"></pre></td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <p class="credits">MySQL Slow Query Log Visualizer &copy; 2015 <a href="http://www.4sh.fr">4SH</a> and <a href="http://www.neurofuzzy.net">Neurofuzzy Consulting</a></p>
    </body>
</html>
